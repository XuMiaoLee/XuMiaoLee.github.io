{"pages":[{"title":"","text":"博主还没有留下印记哦~","link":"/about/index.html"}],"posts":[{"title":"欢迎大家来到我的个人博客~","text":"~ unsplash-logoByron Barros","link":"/2018/02/07/HelloWorld/"},{"title":"Nginx常用技巧","text":"隐藏nginx服务信息头 隐藏nginx版本信息（nginx.conf） 123http { server_tokens off;} 隐藏nginx标识 nginx源码目录：/nginx-1.15.1/src/http/ngx_http_header_filter_module.c 修改 48、49行代码： 12static u_char ngx_http_server_string[] = &quot;Server: XXX&quot; CRLF;static u_char ngx_http_server_full_string[] = &quot;Server: XXX&quot; CRLF; 重新编译nginx，关于编译参数可以使用nginx -V查看 123$ ./configure --prefix=/usr/local/nginx --user=nginx --group=nginx --with-http_ssl_module --with-http_realip_module --with-http_geoip_module --with-http_stub_status_module --with-http_sub_module --with-stream --with-stream=dynamic$ make make之后在objs目录下就多了个nginx，这个就是新编译后的版本程序了，接着我们备份原有nginx程序 1$ mv /usr/local/nginx/sbin/nginx /usr/local/nginx/sbin/nginx.bak 拷贝到编译好的objs下的nginx到sbin目录下 1$ cp objs/nginx /usr/local/nginx/sbin/nginx 停止并启动nginx 12$ pkill -9 nginx$ /usr/local/nginx/sbin/nginx -c /etc/nginx/nginx.conf 按天数切割access.log cut_nginx_log.sh 1234567891011121314151617181920#!/bin/bash##零点执行该脚本##nginx日志文件所在的目录LOGS_PATH=/data/log/nginx##获取昨天的yyyy-MM-ddYESTERDAY=$(date -d \"yesterday\" +%Y-%m-%d)##移动文件mv ${LOGS_PATH}/access.log ${LOGS_PATH}/access_${YESTERDAY}.log##向nginx主进程发送USR1信号，USR1信号是重新打开日志文件kill -USR1 `ps axu | grep \"nginx: master process\" | grep -v grep | awk '{print $2}'`##删除7天前的日志cd ${LOGS_PATH}find . -mtime +7 -name \"access_*\" | xargs rm -fexit 0 执行 crontab -e 添加定时脚本,每天凌晨0点执行任务 10 0 * * * sh /var/log/nginx/cut_nginx_log.sh unsplash-logoJR Korpa","link":"/2018/02/07/运维/Nginx常用技巧/"}],"tags":[{"name":"nginx","slug":"nginx","link":"/tags/nginx/"}],"categories":[{"name":"运维","slug":"运维","link":"/categories/运维/"}]}